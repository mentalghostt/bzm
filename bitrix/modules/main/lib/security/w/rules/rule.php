<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1591908167']= array(base64_decode('aXNfc'.'3'.'RyaW5n'),base64_decode('c3'.'RydG9s'.'b3dlcg=='),base64_decode('a'.'X'.'NfY'.'X'.'JyY'.'Xk='),base64_decode('aXNf'.'c3Rya'.'W5'.'n'),base64_decode('Z'.'3p'.'kZ'.'WNvZGU='),base64_decode('Y'.'mFzZ'.'TY0X2RlY29kZQ'.'=='),base64_decode('d'.'X'.'JsZGVjb2Rl'),base64_decode('YXJy'.'YXlfcmV'.'2ZX'.'JzZQ=='),base64_decode(''.'Z'.'3plb'.'mNvZG'.'U='),base64_decode('YmFzZT'.'Y0X2VuY29'.'kZQ=='),base64_decode('dXJs'.'ZW'.'5j'.'b2'.'Rl'),base64_decode('Y'.'ml'.'uMmh'.'leA=='),base64_decode('a'.'XNfYXJyY'.'Xk='),base64_decode('c3RydG'.'9'.'sb3d'.'lcg=='),base64_decode(''.'aXNf'.'YXJ'.'yYX'.'k='),base64_decode('am9pbg='.'='),base64_decode('Zm'.'5tYXR'.'jaA'.'=='),base64_decode('cmF3dXJsZ'.'GVj'.'b'.'2Rl'),base64_decode('c3Vic3Ry'),base64_decode('c3Vic3'.'Ry'),base64_decode('c3RyX'.'3JlcGxhY2U'.'='),base64_decode(''.'cHJlZ19xd'.'W90'.'ZQ='.'='),base64_decode('cHJl'.'Z19tYX'.'RjaA=='));if(!function_exists(__NAMESPACE__.'\\___578055876')){function ___578055876($_634966445){static $_284174434= false; if($_284174434 == false) $_284174434=array('YWN0a'.'W9u','aW50'.'d'.'m'.'F'.'s','cGF0aA==','Y29udGV'.'4dA==','a'.'2V5cw==','cHJvY2Vzcw==','ZW5'.'j'.'b2Rp'.'bmc=','cHJ'.'lZ1'.'9yZ'.'X'.'B'.'sYW'.'Nl',''.'cG'.'F0'.'aA==',''.'Y29udGV'.'4'.'d'.'A==','a2V5'.'cw='.'=','cHJvY2Vzcw==',''.'ZW'.'5'.'jb2Rpbmc=','cGF0'.'dGVybg==','cHJlZ1'.'9t'.'YX'.'Rja'.'A'.'==','cGF0aA==','Y29'.'udGV4dA==','a'.'2V'.'5'.'cw==','cHJv'.'Y2Vzcw==',''.'ZW5jb2Rpbmc=','cG'.'F0dGVybg'.'==','cG9zdF9'.'h'.'Y3R'.'pb2'.'4'.'=',''.'Y2hlY2'.'tfY3'.'N'.'yZg==','cGF0'.'aA==','Y29u'.'dGV4dA==','a2V5c'.'w==',''.'c'.'HJv'.'Y2'.'Vzcw==','ZW5jb2Rpbmc=','c'.'GF0dG'.'Vyb'.'g==','YWN'.'0aW9'.'u','Y'.'WN0aW9u','YWN0'.'a'.'W9u','Y'.'WN0aW9u',''.'YW'.'N0aW9u','Y'.'WN0'.'a'.'W9u','cG9'.'zdF9hY'.'3Rpb24=','ZW5jb2'.'R'.'pbmc=',''.'ZW5jb'.'2'.'R'.'pb'.'mc=',''.'ZW'.'5jb2'.'R'.'pbmc'.'=',''.'Z'.'W'.'5j'.'b2Rp'.'bmc'.'=','ZW5jb'.'2'.'Rpbm'.'c=','ZW5jb2'.'Rpbmc=','Z'.'3'.'o=',''.'YmFzZT'.'Y0','d'.'XJs','aGV4',''.'Lg'.'==','L'.'w'.'==','aW5k'.'ZXgucGhw','L2luZ'.'GV4'.'L'.'nBocA'.'==',''.'U0NSSVBUX'.'05BTUU=','L2l'.'u'.'ZGV'.'4LnB'.'o'.'c'.'A==','U'.'0'.'NSSVBUX05B'.'TUU=',''.'U0N'.'SSVBUX0'.'5BTUU'.'=','U0NSSVBUX05BTU'.'U=','fg==',''.'f'.'l4=',''.'fg='.'=','X'.'H4=','JH4=');return base64_decode($_284174434[$_634966445]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_274002852; protected $_2115764906; protected $_250142581; protected $_512643513; protected $_670740934; public static function make(array $_1305097320):?static{ $_1305097320= static::prepareRuleParameters($_1305097320); return match($_1305097320[___578055876(0)]){ ___578055876(1) => new IntvalRule( $_1305097320[___578055876(2)], $_1305097320[___578055876(3)], $_1305097320[___578055876(4)], $_1305097320[___578055876(5)], $_1305097320[___578055876(6)]), ___578055876(7) => new PregReplaceRule( $_1305097320[___578055876(8)], $_1305097320[___578055876(9)], $_1305097320[___578055876(10)], $_1305097320[___578055876(11)], $_1305097320[___578055876(12)], $_1305097320[___578055876(13)]), ___578055876(14) => new PregMatchRule( $_1305097320[___578055876(15)], $_1305097320[___578055876(16)], $_1305097320[___578055876(17)], $_1305097320[___578055876(18)], $_1305097320[___578055876(19)], $_1305097320[___578055876(20)], $_1305097320[___578055876(21)]), ___578055876(22) => new CsrfRule( $_1305097320[___578055876(23)], $_1305097320[___578055876(24)], $_1305097320[___578055876(25)], $_1305097320[___578055876(26)], $_1305097320[___578055876(27)], $_1305097320[___578055876(28)],), default => null,};} protected static function prepareRuleParameters(array $_1204256186): array{ if($GLOBALS['____1591908167'][0]($_1204256186[___578055876(29)])){ $_1204256186[___578055876(30)]= $GLOBALS['____1591908167'][1]($_1204256186[___578055876(31)]);} elseif($GLOBALS['____1591908167'][2]($_1204256186[___578055876(32)])){ $_976627258= $_1204256186[___578055876(33)]; $_1204256186[___578055876(34)]= $_976627258[min(46,0,15.333333333333)]; $_1204256186[___578055876(35)]= $_976627258[round(0+1)];} $_1204256186[___578055876(36)]=!empty($_1204256186[___578055876(37)])? $_1204256186[___578055876(38)]:[]; if($GLOBALS['____1591908167'][3]($_1204256186[___578055876(39)])){ $_1204256186[___578055876(40)]=[$_1204256186[___578055876(41)]];} return $_1204256186;}  public function __construct($_274002852, $_2115764906, $_250142581, $_512643513, $_670740934){ $this->_274002852= $_274002852; $this->_2115764906= $this->castContext($_2115764906); $this->_250142581= $this->castKeys($_250142581); $this->_512643513= $_512643513; $this->_670740934= $_670740934;} public function evaluateValue($_364411561){ if(!empty($this->_670740934)){ foreach($this->_670740934 as $_1719554387){ $_364411561= match($_1719554387){ 'gz' => $GLOBALS['____1591908167'][4]($_364411561), 'base64' => $GLOBALS['____1591908167'][5]($_364411561), 'url' => $GLOBALS['____1591908167'][6]($_364411561), 'hex' => hex2bin($_364411561)};}} $_1654574699= $this->evaluate($_364411561); if(!empty($this->_670740934) && $_1654574699 instanceof ModifyResult){ $_1915268931= $_1654574699->getCleanValue(); foreach($GLOBALS['____1591908167'][7]($this->_670740934) as $_1719554387){ $_1915268931= match($_1719554387){ ___578055876(42) => $GLOBALS['____1591908167'][8]($_1915268931), ___578055876(43) => $GLOBALS['____1591908167'][9]($_1915268931), ___578055876(44) => $GLOBALS['____1591908167'][10]($_1915268931), ___578055876(45) => $GLOBALS['____1591908167'][11]($_1915268931)};} $_1654574699= new ModifyResult($_1915268931);} return $_1654574699;} abstract public function evaluate($_364411561); protected function castContext($_2115764906){ if(!$GLOBALS['____1591908167'][12]($_2115764906)){ $_2115764906=[$_2115764906];} foreach($_2115764906 as $_1470487344 => $_903408115){ $_2115764906[$_1470487344]= $GLOBALS['____1591908167'][13]($_903408115);} return $_2115764906;} protected function castKeys($_250142581){ if(!$GLOBALS['____1591908167'][14]($_250142581)){ $_250142581=[$_250142581];} return $_250142581;} public function matchKey(array $_2138364902): bool{ $_2138364902= $GLOBALS['____1591908167'][15](___578055876(46), $_2138364902); foreach($this->_250142581 as $_1278604238){   if($GLOBALS['____1591908167'][16]($_1278604238, $_2138364902)){ return true;}} return false;}  public function matchPath($_1536444910){ if($this->_274002852 === '*'){ return true;}  $_1441263158= new Uri($_1536444910); $_169046599= $_1441263158->getPath(); $_169046599= $GLOBALS['____1591908167'][17]($_169046599);      if(str_ends_with($_169046599, ___578055876(47))){ $_169046599 .= ___578055876(48);} $_169046599= Path::normalize($_169046599);  $_1502667842[]= $_169046599; if(str_ends_with($_169046599, ___578055876(49))){ $_1502667842[]= $GLOBALS['____1591908167'][18]($_169046599,(213*2-426),-round(0+9));} elseif(str_ends_with($_SERVER[___578055876(50)], ___578055876(51))){ $_1502667842[]= $GLOBALS['____1591908167'][19]($_SERVER[___578055876(52)], min(232,0,77.333333333333),-round(0+1.8+1.8+1.8+1.8+1.8));} if($_169046599 !== $_SERVER[___578055876(53)]){ $_1502667842[]= $_SERVER[___578055876(54)];}  if(str_starts_with($this->_274002852, ___578055876(55))){ $_1607446972= $this->_274002852;} else{ $_1607446972= ___578055876(56). $GLOBALS['____1591908167'][20](___578055876(57), ___578055876(58), $GLOBALS['____1591908167'][21]($this->_274002852)). ___578055876(59);} foreach($_1502667842 as $_1911817008){ if($this->_274002852 === $_1911817008 || $GLOBALS['____1591908167'][22]($_1607446972, $_1911817008)){ return true;}} return false;}  public function getPath(){ return $this->_274002852;}  public function getContext(){ return $this->_2115764906;}  public function getKeys(){ return $this->_250142581;}  public function getProcess(){ return $this->_512643513;}}?>